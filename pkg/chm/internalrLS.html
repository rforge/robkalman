<html><head><title>Internal functions of package robKalman for the rLS filter</title>
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>internalrLS(robKalman)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   internalrLS">
<param name="keyword" value="R:   .rLSinitstep">
<param name="keyword" value="R:   .rLSpredstep">
<param name="keyword" value="R:   .rLScorrstep">
<param name="keyword" value=" Internal functions of package robKalman for the rLS filter">
</object>


<h2>Internal functions of package robKalman for the rLS filter</h2>


<h3>Description</h3>

<p>
This function is used internally by package robKalman for the rLS filter
</p>


<h3>Usage</h3>

<pre>
.rLScorrstep(y, x1, S1, Z, V,  rob1=NULL, b, norm=Euclidnorm, ...) 
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>Z</code></td>
<td>
observation matrix (see below)</td></tr>
<tr valign="top"><td><code>V</code></td>
<td>
observation error covariance (see below)</td></tr>
<tr valign="top"><td><code>b</code></td>
<td>
clipping height <code>b</code> for the rLS filter</td></tr>
<tr valign="top"><td><code>norm</code></td>
<td>
a function with a numeric vector <code>x</code> as first argument, 
returning a norm of <code>x</code> - not necessarily, but defaulting to, Euclidean norm; 
used by rLS filter to determine "too" large corrections</td></tr>
<tr valign="top"><td><code>S1</code></td>
<td>
prediction error covariance <i>S_{t|t-1}</i> of the classical Kalman filter</td></tr>
<tr valign="top"><td><code>rob1</code></td>
<td>
not used here; included for compatibility reasons; set to <code>NULL</code></td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
observation <i>y_t</i></td></tr>
<tr valign="top"><td><code>x1</code></td>
<td>
(rLS Kalman)- predicted state <i>x_{t|t-1}</i></td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
not used here; for compatibility with signatures of other "step"-functions</td></tr>
</table>

<h3>Details</h3>

<p>
We work in the setup of the time-invariant, linear, Gaussian state space model (ti-l-G-SSM)
with <i>p</i> dimensional states <i>x_t</i> and <i>q</i> dimensional observations <i>y_t</i>,
with <STRONG>initial condition</STRONG>
</p><p align="center"><i>x_0 ~ N_p(a,S),</i></p>
<p>
<STRONG>state equation</STRONG>
</p><p align="center"><i>x_t = F x_{t-1} +  v_t,          v_t ~ N_p(0,Q),  t&gt;=1,</i></p>
<p>
<STRONG>observation equation</STRONG>
</p><p align="center"><i>y_t = Z x_t   +  e_t,      e_t ~ N_q(0,V),  t&gt;=1,</i></p><p>
and where all random variable <i>x_0</i>, <i>v_t</i>, <i>e_t</i> are independent.
</p>
<p>
For notation, let us formulate the classical Kalman filter in this context:
</p>
<p>
<STRONG>(0) ininitial step</STRONG>          </p><p align="center"><i>x_{0|0}   = a</i></p><p> 
<i><code>      </code></i> with error covariance      
</p><p align="center"><i>S_{0|0}   = Cov(x_0-x_{0|0})   = S</i></p>
<p>
<STRONG>(1) prediction step</STRONG>       
</p><p align="center"><i>x_{t|t-1} = F x_{t-1|t-1},         t&gt;=1</i></p><p>
<i><code>      </code></i> with error covariance      
</p><p align="center"><i>S_{t|t-1} = Cov(x_t-x_{t|t-1}) = F S_{t-1|t-1} F' + Q</i></p>
<p>
<STRONG>(2) correction step</STRONG>       
</p><p align="center"><i>x_{t|t}   = x_{t|t-1} + K_t (y_t - Z x_{t|t-1}),        t&gt;=1</i></p><p>
<i><code>      </code></i> for Kalman Gain   
</p><p align="center"><i>K_t = S_{t|t-1} Z' (Z S_{t|t-1} Z' + V )^-</i></p><p>
<i><code>      </code></i> with error covariance 
</p><p align="center"><i>S_{t|t}   = Cov(x_t-x_{t|t}) = S_{t|t-1} - K_t Z S_{t|t-1}</i></p>


<h3>Value</h3>

<p>
<code>.rLScorrstep(y, x1, S1, Z, V, b)</code>  calculates rLS-<i>x_{t|t}</i> for arguments <code>b</code>, <code>x1 =</code><i>x_{t|t-1}</i> (from rLS-past), 
<code>y =</code><i>y_{t}</i>,  <code>S1 =</code><i>S_{t|t-1}</i>, <code>Z</code>, and  <code>V</code> as above<br></p>

<h3>Author(s)</h3>

<p>
Peter Ruckdeschel <a href="mailto:Peter.Ruckdeschel@uni-bayreuth.de">Peter.Ruckdeschel@uni-bayreuth.de</a>,<br>
</p>


<h3>References</h3>

<p>
Ruckdeschel, P. (2001) <EM>Ans"atze zur Robustifizierung des
Kalman Filters.</EM> Bayreuther Mathematische Schriften, Vol. 64.
</p>


<h3>See Also</h3>

<p>
<code><a href="internalKalman.html">internalKalman</a></code>
</p>



<hr><div align="center">[Package <em>robKalman</em> version 0.1 <a href="00Index.html">Index]</a></div>

</body></html>
